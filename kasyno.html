<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Kansino Offline</title>
  <style>
    body {
      background: #111;
      color: #fff;
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 20px;
    }
    h1 {
      font-size: 3em;
      margin-bottom: 10px;
    }
    .casino-select {
      margin: 20px 0;
    }
    .slot-machine {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin: 30px 0;
      font-size: 3em;
    }
    .result {
      font-size: 2em;
      margin-top: 20px;
    }
    .fireworks {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 999;
    }
    .balance-info {
      margin: 20px;
      font-size: 1.5em;
    }
    #clown-face {
      width: 150px;
      height: 150px;
      margin: 20px auto;
      background-size: cover;
    }
  </style>
</head>
<body>
  <h1>Kansino Offline</h1>

  <div class="casino-select">
    <label for="casino">Wybierz kasyno:</label>
    <select id="casino">
      <option value="joker">Joker Casino</option>
      <option value="lucky">Lucky Kasino</option>
      <option value="gold">Golden Spin</option>
      <option value="retro">Retro Slots</option>
    </select>
    <br><br>
    <label for="bet">Postaw (żetony):</label>
    <input type="number" id="bet" min="1" value="10">
    <button onclick="playSlot()">Zakręć!</button>
  </div>

  <div class="balance-info">Stan konta: <span id="balance">100</span> żetonów</div>

  <div class="slot-machine" id="slots">
    <div>?</div>
    <div>?</div>
    <div>?</div>
    <div>?</div>
    <div>?</div>
  </div>

  <div class="result" id="result"></div>

  <div id="clown-face"></div>

  <canvas class="fireworks" id="fireworks"></canvas>

  <audio id="win-sound" src="https://www.myinstants.com/media/sounds/slot-machine-big-win.mp3"></audio>
  <audio id="lose-sound" src="https://www.myinstants.com/media/sounds/sad-trombone.mp3"></audio>
  <audio id="spin-sound" src="https://www.myinstants.com/media/sounds/slot-machine.mp3"></audio>

  <script>
    const symbols = ["🍒", "🔔", "🍋", "⭐", "💎"];
    let balance = 100;

    function playSlot() {
      const bet = parseInt(document.getElementById('bet').value);
      if (bet > balance || bet <= 0) {
        alert("Nie masz wystarczająco żetonów lub nieprawidłowa stawka.");
        return;
      }

      document.getElementById("spin-sound").play();

      const slotElements = document.querySelectorAll('#slots div');
      const result = [];
      for (let i = 0; i < 5; i++) {
        const symbol = symbols[Math.floor(Math.random() * symbols.length)];
        slotElements[i].textContent = symbol;
        result.push(symbol);
      }

      const counts = {};
      result.forEach(sym => counts[sym] = (counts[sym] || 0) + 1);

      let output = 'Spróbuj jeszcze raz...';
      let reward = 0;
      let fireworks = false;

      for (let key in counts) {
        if (counts[key] === 3) {
          reward = bet * 2;
          output = '🎉 BIG WIN! 🎉';
          document.getElementById("win-sound").play();
        } else if (counts[key] >= 4) {
          reward = bet * 5;
          output = '💥💥 MEGA WIN!!! 💥💥';
          fireworks = true;
          document.getElementById("win-sound").play();
        }
      }

      if (reward === 0) {
        balance -= bet;
        document.getElementById("lose-sound").play();
      } else {
        balance += reward;
      }

      document.getElementById('balance').textContent = balance;
      document.getElementById('result').textContent = output;

      updateClownFace(balance);

      if (fireworks) startFireworks();
    }

    function updateClownFace(balance) {
      const clown = document.getElementById('clown-face');
      if (balance < 30) {
        clown.style.backgroundImage = "url('https://i.imgur.com/FYDLH2m.png')"; // śmiejący się klaun
      } else if (balance > 150) {
        clown.style.backgroundImage = "url('https://i.imgur.com/sYcyrZQ.png')"; // zdziwiony klaun
      } else {
        clown.style.backgroundImage = "none";
      }
    }

    const canvas = document.getElementById('fireworks');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    function startFireworks() {
      let particles = [];
      for (let i = 0; i < 100; i++) {
        particles.push({
          x: canvas.width / 2,
          y: canvas.height / 2,
          dx: Math.random() * 10 - 5,
          dy: Math.random() * 10 - 5,
          life: 100
        });
      }
      let interval = setInterval(() => {
        ctx.fillStyle = "rgba(0, 0, 0, 0.1)";
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        particles.forEach(p => {
          ctx.fillStyle = `hsl(${Math.random() * 360}, 100%, 50%)`;
          ctx.beginPath();
          ctx.arc(p.x, p.y, 2, 0, Math.PI * 2);
          ctx.fill();
          p.x += p.dx;
          p.y += p.dy;
          p.life--;
        });
        particles = particles.filter(p => p.life > 0);
        if (particles.length === 0) clearInterval(interval);
      }, 30);
    }
  </script>
</body>
</html>
